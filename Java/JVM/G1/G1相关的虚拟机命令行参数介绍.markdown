# G1调优相关的虚拟机命令行参数介绍

Hotspot命令行参数的使用有2种格式：

> * 第一种，如果参数的值是布尔类型，就在参数的前面加“+”或“-”表示真或假。例如-XX:+PrintAdaptiveSizePolicy
表示启用PrintAdaptiveSizePolicy，类似-XX:-PrintAdaptiveSizePolicy参数表示禁用该功能。  

> * 第二种，给数值性参数或指定的关键词列表使用的，此类参数不需要加“+”或“-”符号，例如-XX:ConcGCThreads是数值型参数，可直接使用-XX:ConcGCThreads=6。

<strong>特别说明：</strong>以下提到的参数默认值来自JDK8u45版本。  

### -XX:+UseG1GC

启用G1垃圾收集器，JDK7和8中需要显式启用，JDK9默认启用。

### -XX:ConcGCThreads  

设定并行执行GC的Java线程数，默认值近似整个应用线程数的四分之一。  

减少该参数值可能提升并行回收的效率，即提高系统的内部吞吐量（系统是一个整体，大家都需要占用CPU资源），不过数值过低，也会导致并行回收机制耗时加长。  

### -XX:G1HeapRegionSize  

设置G1的每个Region的大小，默认为堆内存大小的1/2000，单位为MB，且数值只能是1、2、4、8、16、32其中之一。  

如果对象大小超过一个Region的一半，G1需要特别管理此类大对象。增大该值，大对象就可以进入Region，对于有很多大对象的应用有助于提高应用性能，缺点是直接干预了各年龄代的分配大小。  

### -XX:G1HeapWastePercent

G1不会回收的内存大小，默认是堆大小的5%。

GC会收集所有的Region，直到剩余的值达到该参数设定的值，就会停止收集。对于大堆来说，需要降低该值。

### -XX:G1MixedGCCountTarget

设置并行循环之后需要有多少个混合GC启动，默认值为8个。  

老年代Region的回收时间通常会比新生代时间长，所以该参数设置允许更多的混合GC同时回收老年代，同样，增大该参数也会增大GC的启动时间。如果混合GC中断应用的时间太长，可以考虑调大该参数。


### -XX:+G1PrintGregionLivenessInfo

该参数需和-XX:+UnlockDiagnosticVMOptions配合启动，它们本身属于VM的调试信息。如果开启，VM会打印堆内存里每个Region的存活对象信息，该信息包含对象的具体使用、可记忆集合大小
以及很价值的GC效率的统计值。不利方面是日志数据会比较大。

### -XX:G1Reservepercent

G1为了保留一些空间用于年代之间的提升，默认值为堆空间的10%。注意这个空间保留后就不会用在年轻代。  

如果应用有比较大的堆内存空间、比较多的大对象存活，建议减少一些保留空间，这样会给年轻代更多的预留空间、GC之间的会有更长的间隔时间，对于性能提升有帮助。


### -XX:+G1SummarizeRSetStats

该参数是虚拟机的诊断调试参数，需要和-XX:+UnlockDiagnosticVMOptions配合启用。如果开启，会在虚拟机退出时打印可记忆集合的详细统计信息。如果和-XX:G1SummarizeRSetStatsPeriod参数配合使用，统计信息会周期性输出。
如果怀疑和可记忆集合有关的问题，应用使用此参数配合分析。

### -XX:G1SummarizeRSetStatsPeriod

该参数是虚拟机的诊断调试参数，需要和-XX:+UnlockDiagnosticVMOptions配合启用，并且只能和-XX:+G1SummarizeRSetStats一起使用。  

该参数设置为非零值n，虚拟机将打印每n次GC后可记忆集合的详细统计信息。GC打印此信息成本较高，周期性打印能分析出可记忆集合的使用趋势。  

### -XX:G1TraceConcRefinement

该参数是虚拟机的诊断调试参数，需要和-XX:+UnlockDiagnosticVMOptions配合启用。

该参数启用后，多线程的并发执行优化的具体信息会被输出到日志信息中。日志会记录多线程并发执行优化的开始和结束，有利于分析多线程并发执行优化导致的问题。  

### -XX:G1UseAdaptiveConcRefinement


### -XX:GCTimeRatio


### -XX:+HeapDumpBeforeFullGC

### -XX:+HeapDumpAfterFullGC


### -XX:InitiatingHeapOccupancyPercent


### -XX:+UseStringDeduplication



