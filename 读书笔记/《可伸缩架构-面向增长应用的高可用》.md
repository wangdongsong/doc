# 01 - 什么是可用性


* 可用性，一般指系统在其能力范围内执行任务的能力。为了正常执行系统功能操作，系统当前可运行的能力。
* 可靠性，一般批系统的质量，一个系统能够按照技术标准持续运行的能力。系统是否具备无差错的执行预期操作的能力。

#### 以下因素导致低可用性

* 资源耗尽， 用户数量增加，导致系统使用的数据量增加，从而可能导致系统资源耗尽，应用程序运行越来越慢并最终无响应。

* 预期之外的压力变化， 应用使用的人越来越多，应用程序的代码修改不足以支撑不断增加的压力，缺乏足够的考虑或计划，因此也增加了问题出现的可能性。

* 流动行为增加， 应用程序高速发展，需要更多开发、测试、设计等其它人员来维护，大量的个体协作会产生大量的流动行为，包括新功能、变更功能、等。这些流动
行为的增加从而增加了相互之间的负面作用的可能。

* 外部依赖， 应用程序依赖的外部资源越多，由于这些资源导致的可用性问题就会越多。

* 技术债务， 应用程序复杂性的增加，通常会导致技术债务（例如未修复的Bug增、未实现的修改等），技术债务会增加可用性问题出现的可能。

# 02 - 提高应用程序可用性的五个要点

> * 时刻考虑应对故障
> * 时刻考虑如何伸缩
> * 缓和风险
> * 监控可用性
> * 以可预期及明确的方式处理可用性问题

### 时刻考虑应对故障

提前为应用程序和服务发生故障而做出计划，假设应用程序发生故障，如何发生？在构建系统时应该在设计和实现的方方面面都考虑可用性，例如：

> * 设计：通过使用一些设计模式，例如捕获底层异常、重试逻辑和断路器，可以帮助我们捕获错误并尽可能避免影响其它功能。<strong>可以限制问题的影响范围，保证核心业务功能</strong>
> * 依赖：依赖组件出现异常，如何处理？重试、断路器，降低依赖故障对你的系统的影响。  
> * 用户：用户参与某项活动导致大量请求增加，流量突然间的增加使用应用程序宕机，能否检测流量突间增加的异常，通过限制请求的速度降低或消除它们的影响。

### 时刻考虑如何伸缩

大多数Web应用程序的流量都在不断增加，在设计及构建系统时，不要只考虑当前的流量，要考虑未来的流量，意味着做以下几点：  

> * 设计出能够增加数据库数量和容量的架构。
> * 考虑限制数据伸缩的原因。设想当数据量达到容易极限时发生什么问题？进一步确认问题并在达到极限之前解决。
> * 应当能够很容易的添加额外的应用服务器，需要仔细考虑在何处和如何维护状态，以及流量如何路由。
> * 静态流量导向离线提供方。系统只需处理动态流量（请求），使用外部的内容分发内容（CDN）不仅降低网络需要处理的流量，也能利用CDN的伸缩效率将静态内容更快地分发给用户。  
> * 考虑是否静态生成一些动态资源，提高程序的可伸缩性。“应用静态的动态资源”，例如：导航栏多数内容是静态的，登录icon及登录后的显示是动态的，采用动静分离，使用CDN分发静态。  

### 缓和风险

保持系统高可用需要消除系统中的风险，首先要确认风险，所有系统中都存在以下风险：

> * 系统崩溃的风险
> * 数据库崩溃的风险
> * 返回结果不正常的风险
> * 网络连接失败的风险
> * 新部署的软件功能出现故障的风险

保持高可用，就需要消除上述风险。但系统越来越复杂时，消除所有风险不可能实现。保持一个大型系统的高可用，更多的是来管理系统的风险。对风险分级，确认风险是什么，哪些可接受，以及能够采取什么措施缓和风险。  

风险管理中的一个部分是风险缓和，指问题发生时，如何去尽可能降低问题所带来的影响。缓和意味着即使服务不可用时，依然尽可能确保系统以最好、最完整的状态工作。

例如：应用程序Down之后会404提示，之前若网页不存在，直接提示404或500，现在百度或其它网站直接给出相关性的内容提示用户。A依赖B，若B服务宕机后，A能否给出相应提示，让用户转去别的服务。

### 监控可用性

### 以可预期及明确的方式来处理可用性问题
